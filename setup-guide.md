# マインドエンジニアリング・コーチング管理システム セットアップガイド

このガイドでは、マインドエンジニアリング・コーチング管理システムの初期セットアップと使用方法について説明します。

## 前提条件

- Google アカウント
- Google Drive へのアクセス
- Google Apps Script の基本的な知識（オプション）

## 1. システムのセットアップ

### 1.1. Google Sheets データベースの作成

1. Google Drive にアクセスし、新規 Google スプレッドシートを作成します
2. スプレッドシート名を「マインドエンジニアリング・コーチング管理システム」に変更します
3. 以下のシートを作成します：
   - クライアントinfo
   - セッション管理
   - 支払い管理
   - メールログ
   - 設定
   - メールテンプレート

4. 各シートのヘッダー行を設定します（詳細は `database-structure.md` を参照）

### 1.2. 設定シートの初期化

設定シートに以下の基本設定を入力します：

| 設定キー | 設定値 | 説明 |
|---------|-------|------|
| ADMIN_EMAIL | mindengineeringcoaching@gmail.com | 管理者メール |
| SERVICE_NAME | マインドエンジニアリング・コーチング | サービス名 |
| MAIL_SENDER_NAME | マインドエンジニアリング・コーチング 森山雄太 | 送信者名 |
| CORPORATE_COLOR | #c50502 | コーポレートカラー |
| TRIAL_FEE | 6000 | トライアル料金 |
| CONTINUATION_FEE | 214000 | 継続セッション料金 |
| SESSION_DURATION | 30 | セッション時間（分） |

### 1.3. Google Forms の設定

1. Google Forms にアクセスし、新規フォームを作成します
2. フォーム名を「マインドエンジニアリング・コーチング申込フォーム」に変更します
3. 以下の質問項目を設定します：
   - メールアドレス（必須）
   - お名前（必須）
   - お名前（カナ）（必須）
   - 性別
   - 生年月日
   - 電話番号（ハイフンなし）（必須）
   - ご住所
   - 希望セッション形式（ラジオボタン：「オンライン」「対面」「どちらでも可」）
   - 備考欄

4. フォームの回答先として、先ほど作成したスプレッドシートの「クライアントinfo」シートを指定します

### 1.4. Google Apps Script プロジェクトの設定

1. スプレッドシートから「拡張機能」→「Apps Script」を選択します
2. 本リポジトリのコードファイルを適切にプロジェクトにコピーします：
   - `Code.gs` → プロジェクトのメインスクリプトファイル
   - `Dashboard.html` → HTML ファイル（新規作成）
   - `CSS.html` → HTML ファイル（新規作成）
   - `JavaScript.html` → HTML ファイル（新規作成）

3. スクリプトプロパティを設定します：
   - メニューから「ファイル」→「プロジェクトのプロパティ」→「スクリプトのプロパティ」を選択
   - `SPREADSHEET_ID` - スプレッドシートの ID を追加

4. デプロイ設定：
   - 「デプロイ」→「新しいデプロイ」をクリック
   - デプロイタイプで「ウェブアプリ」を選択
   - 次のユーザーとして実行：「自分」
   - アクセスできるユーザー：「全員」または「指定したユーザー」
   - デプロイをクリック
   - 生成された URL をメモします（これが管理ダッシュボードの URL になります）

## 2. Google Forms の自動処理設定

### 2.1. フォーム送信トリガーの設定

1. Apps Script エディタで「トリガー」アイコンをクリック
2. 「トリガーを追加」をクリック
3. 以下のように設定：
   - 実行する関数：`onFormSubmit`
   - イベントのソース：「スプレッドシートから」
   - イベントの種類：「フォーム送信時」
4. 保存をクリック

### 2.2. 定期実行トリガーの設定

1. 同様に以下のトリガーも設定します：
   - 実行する関数：`sendSessionReminders`
   - イベントのソース：「時間主導型」
   - 時間ベースのトリガーのタイプ：「日タイマー」
   - 時刻：「午前9時〜10時」
   - 保存をクリック

## 3. システムの使用方法

### 3.1. 管理ダッシュボードへのアクセス

1. デプロイ時に生成されたウェブアプリの URL にアクセスします
2. Google アカウントでログインすると、ダッシュボードが表示されます

### 3.2. クライアント管理

#### 新規クライアントの確認
1. ダッシュボードの「対応が必要なタスク」セクションで新規申込を確認します
2. クライアント一覧から新規クライアントの詳細を確認できます

#### クライアント詳細の確認
1. クライアント一覧から氏名をクリックするか、詳細アイコンをクリックします
2. クライアント詳細モーダルが表示され、基本情報、セッション履歴、支払い履歴、メモなどが確認できます

### 3.3. セッション管理

#### 新規セッションの予約
1. ダッシュボードの「+新規セッション」ボタンをクリックします
2. クライアント、セッション種別、日時、形式を入力します
3. 「予約する」をクリックすると、セッションが作成されます
4. オンラインセッションの場合、Google Meet リンクが自動生成されます

#### セッション詳細の確認と完了
1. セッション一覧から詳細アイコンをクリックします
2. セッション詳細モーダルが表示されます
3. セッション完了後、メモを入力して「セッション完了」をクリックします

### 3.4. リマインダー管理

1. ダッシュボードの「対応が必要なタスク」セクションでリマインダー送信が必要なセッションを確認します
2. 「リマインダー送信」ボタンをクリックすると、クライアントにリマインダーメールが送信されます

### 3.5. 支払い管理

1. クライアント詳細画面の「支払い履歴」タブで支払い状況を確認します
2. 未入金のクライアントには、メール送信機能を使って支払い案内を送信できます

## 4. システムのカスタマイズ

### 4.1. メールテンプレートの編集

1. スプレッドシートの「メールテンプレート」シートでテンプレートを編集します
2. プレースホルダーを使って動的な内容を表示できます：
   - `{{クライアント名}}` - クライアントの名前
   - `{{セッション日時}}` - セッションの日時
   - その他（詳細は `database-structure.md` を参照）

### 4.2. UI のカスタマイズ

1. `CSS.html` ファイルでスタイルを編集できます
2. コーポレートカラーは、`:root` セレクタの `--primary` 変数で一括変更できます

### 4.3. 機能の拡張

新機能を追加したい場合は、以下のファイルを編集します：

- バックエンドロジック：`Code.gs`
- フロントエンドUI：`Dashboard.html`
- スタイル：`CSS.html`
- クライアントサイドロジック：`JavaScript.html`

## 5. トラブルシューティング

### 5.1. ダッシュボードにアクセスできない場合

1. デプロイ設定を確認し、アクセス権限が適切に設定されているか確認します
2. スプレッドシートの共有設定を確認します
3. ブラウザのキャッシュをクリアしてみてください

### 5.2. 自動メールが送信されない場合

1. スクリプトの実行ログでエラーを確認します：
   - Apps Script エディタで「実行」→「実行ログ」を確認
2. Gmail の送信クォータを確認します（Googleアカウントの一日の送信制限）
3. 設定シートのメール設定を確認します

### 5.3. データが表示されない場合

1. スプレッドシートのデータ形式と列の順序が正しいことを確認します
2. スクリプトのコンソールログでエラーを確認します：
   - ブラウザの開発者ツール（F12）を開き、コンソールタブでエラーを確認

## 6. サポートとフィードバック

改善提案やバグ報告は、以下の連絡先までお願いします：

- メール: mindengineeringcoaching@gmail.com

---

© 2025 マインドエンジニアリング・コーチング 森山雄太